<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navbar Hệ thống tổ chức thi chứng chỉ</title>
    <link rel="stylesheet" href="/CSS/Navbar.css">
</head>
<body>
    <nav class="navbar">
        <div class="logo">Hệ thống tổ chức thi chứng chỉ</div>
        <ul class="nav-links">
            <li id="home"><a href="/DangNhap/Home.html">Trang chủ</a></li>
            <li id="register"><a href="dangky.html">Đăng ký</a></li>
            <li id="pay"><a href="thanhtoan.html">Thanh toán</a></li>
            <li id="postpone"><a href="giahan.html">Gia hạn</a></li>
            <a href="/DangNhap/DangNhap.html" id="login">Đăng nhập</a>
            <a href="#" id="logout" style="display: none;">Đăng xuất</a>     
    </nav>
            
    <script>
        async function checkLoginStatus() {
            try {
                const response = await fetch('/check-login', { method: 'GET' });
                const data = await response.json();
                    if (response.ok && data.loggedIn) {
                        document.getElementById('login').style.display = 'none';
                        document.getElementById('logout').style.display = 'block';
                        console.log('Da dang nhap');
                    } else {
                        document.getElementById('login').style.display = 'block';
                        document.getElementById('logout').style.display = 'none';
                        console.log('Chua dang nhap');
                    }
            } catch (error) {                      
                  console.error('Lỗi kiểm tra đăng nhập:', error);
                    }
         }
            
         document.getElementById('logout').addEventListener('click', async function () {
            try {
                const response = await fetch('/logout', { method: 'POST' });
                if (response.ok) {
                    alert('Bạn đã đăng xuất thành công!');
                    window.location.href = '/DangNhap/Home.html';
                }
            } catch (error) {
                console.error('Lỗi đăng xuất:', error);
            }
        });
            
        document.addEventListener("DOMContentLoaded", checkLoginStatus);
    </script>
</body>
</html>